CLASS z_generate_travel_jms DEFINITION
  PUBLIC
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.
    INTERFACES if_oo_adt_classrun.
  PROTECTED SECTION.
  PRIVATE SECTION.
ENDCLASS.

CLASS z_generate_travel_jms IMPLEMENTATION.

  METHOD if_oo_adt_classrun~main.
    " 1. Borrar datos antiguos para no duplicar
    DELETE FROM ztravel_jms.

    " 2. Insertar datos copiados de tabla demo (/DMO/TRAVEL)
    INSERT ztravel_jms FROM (
        SELECT
          FROM /dmo/travel
          FIELDS

            travel_id,
            agency_id,
            customer_id,
            begin_date,
            end_date,
            booking_fee,
            total_price,
            currency_code,
            description,
            status AS overall_status, "Mapeamos status a nuestra columna
            createdby AS created_by,
            createdat AS created_at,
            lastchangedby AS last_changed_by,
            lastchangedat AS last_changed_at,
            lastchangedat AS local_last_changed_at
    ).

    " 3. Dice cuantos ha creado
    out->write( |Se han insertado filas en ZTRAVEL_JMS| ).
  ENDMETHOD.
ENDCLASS.
